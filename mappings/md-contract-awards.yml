md_contract_awards:
  label: Moldova Contract Awards
  info_url: http://tender.gov.md/ro
  category: procurement
  roles:
    - guest
  queries:
    - database: ${DATAVAULT_DATABASE_URI}
      table: md_contract_awards
      entities:
        supplier:
          schema: LegalEntity
          key: md_contract_awards.name
          key_fingerprint: true
          properties:
            name:
              column: md_contract_awards.name
        authority:
          schema: PublicBody
          key: md_contract_awards.autoritatea_contractanta
          key_fingerprint: true
          properties:
            name:
              column: md_contract_awards.autoritatea_contractanta
            country:
              literal: MD
        contract:
          schema: Contract
          keys:
            - md_contract_awards.numarul_procedurii
          properties:
            authority: 
              entity: authority
            name:
              join: " "
              columns: 
                - md_contract_awards.tipul_contractului
                - md_contract_awards.numarul_procedurii
            procedureNumber:
              column: md_contract_awards.numarul_procedurii
            type:
              column: md_contract_awards.tipul_contractului
            noticeId:
              column: md_contract_awards.numar_de_intrare
            numberAwards:
              column: md_contract_awards.numarul_de_participanti
        award:
          schema: ContractAward
          keys:
            - md_contract_awards.id
          properties:
            supplier:
              entity: supplier
            contract: 
              entity: contract
            name:
              join: " part of "
              columns: 
                - md_contract_awards.numarul_documentului
                - md_contract_awards.numarul_procedurii
            decisionReason:
              column: md_contract_awards.raion
            summary:
              column: md_contract_awards.obiectul_achizitiei
            date:
              column: md_contract_awards.data_documentului
            documentNumber:
              column: md_contract_awards.numarul_documentului
            documentType:
              column: md_contract_awards.tipul_documentului
            cpvCode:
              column: md_contract_awards.cpv3
            amount:
              column: md_contract_awards.suma
            currency:
              literal: "MDL"