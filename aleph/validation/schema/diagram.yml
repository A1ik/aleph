DiagramCreate:
  type: object
  properties:
    label:
      type: string
    summary:
      type: string
      nullable: true
    data:
      type: object
      allOf:
      - $ref: '#/components/schemas/DiagramData'
  required: ["label"]

DiagramUpdate:
  type: object
  allOf:
    - $ref: '#/components/schemas/DiagramCreate'
  required: []

Diagram:
  type: object
  allOf:
  - $ref: '#/components/schemas/DatedModel'
  properties:
    collection:
      type: object
      allOf:
      - $ref: '#/components/schemas/Collection'
    role_id:
      type: string
    label:
      type: string
    summary:
      type: string
      nullable: true
    data:
      type: object
      allOf:
      - $ref: '#/components/schemas/DiagramData'
    writeable:
      type: boolean
  required: ["collection", "role_id", "label", "data", "writeable"]

DiagramData:
  type: object
  properties:
    layout:
      type: object
      required: ["entities", "vertices", "edges", "groupings"]
      properties:
        entities:
          type: array
          items:
            type: object
            allOf:
            - $ref: '#/components/schemas/EntityUpdate'
            properties:
              id:
                type: string
            required: ["id", "schema"]
        vertices:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
              type:
                type: string
              label:
                type: string
              fixed:
                type: boolean
              hidden:
                type: boolean
              color:
                type: string
              position:
                type: object
                properties:
                  x:
                    type: number
                  y:
                    type: number
              entityId:
                type: string
        edges:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
              type:
                type: string
              label:
                type: string
              sourceId:
                type: string
              targetId:
                type: string
              entityId:
                type: string
              propertyQName:
                type: string
              labelPosition:
                type: object
                properties:
                  x:
                    type: number
                  y:
                    type: number
        groupings:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
              label:
                type: string
              color:
                type: string
              vertices:
                type: array
                items:
                  type: string
    required: ["layout"]

